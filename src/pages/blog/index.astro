---
import SiteLayout from "../../components/SiteLayout.astro";
import { getCollection, type CollectionEntry } from "astro:content";

const posts: CollectionEntry<"blog">[] = (await getCollection("blog"))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.date.localeCompare(a.data.date));
---

<SiteLayout
  title="專欄 | ALL OUT DESIGN"
  description="裝修設計與工程知識專欄。"
>
  <section class="section">
    <div class="container">
      <h1>專欄</h1>
      <p class="muted">裝修設計與工程知識分享</p>

      <div class="post-grid">
        {posts.map((p) => (
          <a href={`/blog/${p.slug}`} class="card post-card">
            {p.data.coverImage ? (
              <img
                class="post-thumb"
                src={p.data.coverImage}
                alt={p.data.title}
                loading="lazy"
              />
            ) : (
              <div class="post-thumb-placeholder" aria-hidden="true" />
            )}

            <div class="post-meta">
              <h3>{p.data.title}</h3>
              <p class="muted">{p.data.summary}</p>
              <div class="post-date">{p.data.date}</div>
            </div>
          </a>
        ))}
      </div>
    </div>
  </section>
</SiteLayout>
